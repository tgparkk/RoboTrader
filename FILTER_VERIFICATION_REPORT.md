# ë§ˆì´ë„ˆìŠ¤ ìˆ˜ìµ ì¡°í•© í•„í„° ê²€ì¦ ë³´ê³ ì„œ

## ìš”ì•½

ë§ˆì´ë„ˆìŠ¤ ìˆ˜ìµ ì¡°í•© í•„í„°ê°€ **ì •ìƒì ìœ¼ë¡œ ì‘ë™**í•˜ê³  ìˆìŠµë‹ˆë‹¤.

## ê²€ì¦ ê²°ê³¼

### 1. í•„í„° ë¡œì§ ê²€ì¦ âœ…

**í…ŒìŠ¤íŠ¸**: [test_filter_live.py](test_filter_live.py)

ì‹¤ì œ `get_debug_info()` ë°˜í™˜ êµ¬ì¡°ë¡œ 3ê°€ì§€ í…ŒìŠ¤íŠ¸ ìˆ˜í–‰:

| í…ŒìŠ¤íŠ¸ | íŒ¨í„´ ì¡°í•© | ì˜ˆìƒ ê²°ê³¼ | ì‹¤ì œ ê²°ê³¼ | ìƒíƒœ |
|--------|----------|-----------|-----------|------|
| 1 | ì•½í•¨(<4%) + ë³´í†µ(1.5-2.5%) + ì§§ìŒ(â‰¤2) | ì°¨ë‹¨ | ì°¨ë‹¨ | âœ… í†µê³¼ |
| 2 | ë³´í†µ(4-6%) + ë³´í†µ(1.5-2.5%) + ì§§ìŒ(â‰¤2) | í†µê³¼ | í†µê³¼ | âœ… í†µê³¼ |
| 3 | ê°•í•¨(>6%) + ê¹ŠìŒ(>2.5%) + ì§§ìŒ(â‰¤2) | ì°¨ë‹¨ | ì°¨ë‹¨ | âœ… í†µê³¼ |

**ê²°ë¡ **: í•„í„° ë¡œì§ì´ ì •í™•í•˜ê²Œ ì‘ë™í•©ë‹ˆë‹¤.

### 2. ê³¼ê±° ë°ì´í„° ê²€ì¦ âœ…

**í…ŒìŠ¤íŠ¸**: [verify_filter_with_real_data.py](verify_filter_with_real_data.py)

- ì´ íŒ¨í„´: 7,504ê°œ
- debug_info ìˆëŠ” íŒ¨í„´: 7,504ê°œ
- **í•„í„°ë¡œ ì œì™¸ëœ íŒ¨í„´: 1,475ê°œ (19.7%)**
- í†µê³¼í•œ íŒ¨í„´: 6,029ê°œ (80.3%)

**ê²°ë¡ **: ê³¼ê±° ë°ì´í„°ì— ì ìš© ì‹œ ì˜ˆìƒëŒ€ë¡œ ì•½ 20%ì˜ íŒ¨í„´ì´ í•„í„°ë§ë©ë‹ˆë‹¤.

### 3. ì½”ë“œ í†µí•© ê²€ì¦ âœ…

**ìœ„ì¹˜**: [pullback_candle_pattern.py:229-242](core/indicators/pullback_candle_pattern.py:229-242)

```python
# ğŸš« ë§ˆì´ë„ˆìŠ¤ ìˆ˜ìµ ì¡°í•© í•„í„°ë§
if result.has_pattern and pattern_info['debug_info']:
    from core.indicators.pattern_combination_filter import PatternCombinationFilter
    import logging
    logger = logging.getLogger(__name__)

    filter = PatternCombinationFilter(logger=logger)
    should_exclude, exclude_reason = filter.should_exclude(pattern_info['debug_info'])

    if should_exclude:
        logger.info(f"ğŸš« {exclude_reason}")
        # íŒ¨í„´ì„ ë¬´íš¨í™”
        pattern_info['has_support_pattern'] = False
        pattern_info['reasons'].append(exclude_reason)
```

**ê²°ë¡ **: í•„í„°ê°€ ì‹¤ì œ ë§¤ë§¤ ë¡œì§ì˜ ì˜¬ë°”ë¥¸ ìœ„ì¹˜ì— í†µí•©ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

## í•„í„° ì‘ë™ ë°©ì‹

### 1. íŒ¨í„´ ë¶„ì„ ë‹¨ê³„

`SupportPatternAnalyzer.get_debug_info()`ê°€ ë‹¤ìŒ êµ¬ì¡°ì˜ ë”•ì…”ë„ˆë¦¬ ë°˜í™˜:

```python
{
    'uptrend': {
        'price_gain': '4.33%',  # ìƒìŠ¹ë¥ 
        'max_volume': '88,060'
    },
    'decline': {
        'decline_pct': '1.13%',  # í•˜ë½ë¥ 
        'candle_count': 2
    },
    'support': {
        'candle_count': 2,  # ì§€ì§€ ìº”ë“¤ ìˆ˜
        'avg_volume_ratio': '13.3%'
    }
}
```

### 2. í•„í„° ì ìš© ë‹¨ê³„

`PatternCombinationFilter.categorize_pattern()`ì´ íŒ¨í„´ì„ ì¹´í…Œê³ ë¦¬ë¡œ ë¶„ë¥˜:

- **ìƒìŠ¹ê°•ë„**: ì•½í•¨(<4%), ë³´í†µ(4-6%), ê°•í•¨(>6%)
- **í•˜ë½ì •ë„**: ì–•ìŒ(<1.5%), ë³´í†µ(1.5-2.5%), ê¹ŠìŒ(>2.5%)
- **ì§€ì§€ê¸¸ì´**: ì§§ìŒ(â‰¤2), ë³´í†µ(3-4), ê¹€(>4)

### 3. ì œì™¸ íŒì •

11ê°œ ë§ˆì´ë„ˆìŠ¤ ìˆ˜ìµ ì¡°í•©ê³¼ ë§¤ì¹­:

```python
should_exclude, reason = filter.should_exclude(debug_info)

if should_exclude:
    # íŒ¨í„´ ë¬´íš¨í™”
    pattern_info['has_support_pattern'] = False
    pattern_info['reasons'].append(reason)
```

## ì œì™¸ë˜ëŠ” 11ê°œ ì¡°í•©

| # | ìƒìŠ¹ê°•ë„ | í•˜ë½ì •ë„ | ì§€ì§€ê¸¸ì´ | ê±°ë˜ìˆ˜ | ì´ ì†ì‹¤ |
|---|---------|---------|---------|--------|---------|
| 1 | ì•½í•¨(<4%) | ë³´í†µ(1.5-2.5%) | ì§§ìŒ(â‰¤2) | 34ê±´ | -15.38% |
| 2 | ê°•í•¨(>6%) | ì–•ìŒ(<1.5%) | ë³´í†µ(3-4) | 7ê±´ | -9.73% |
| 3 | ë³´í†µ(4-6%) | ì–•ìŒ(<1.5%) | ë³´í†µ(3-4) | 15ê±´ | -5.52% |
| 4 | ê°•í•¨(>6%) | ê¹ŠìŒ(>2.5%) | ì§§ìŒ(â‰¤2) | 36ê±´ | -4.53% |
| 5 | ê°•í•¨(>6%) | ë³´í†µ(1.5-2.5%) | ë³´í†µ(3-4) | 4ê±´ | -4.00% |
| 6 | ë³´í†µ(4-6%) | ê¹ŠìŒ(>2.5%) | ë³´í†µ(3-4) | 1ê±´ | -2.50% |
| 7 | ì•½í•¨(<4%) | ë³´í†µ(1.5-2.5%) | ë³´í†µ(3-4) | 1ê±´ | -2.50% |
| 8 | ì•½í•¨(<4%) | ë³´í†µ(1.5-2.5%) | ê¹€(>4) | 4ê±´ | -1.83% |
| 9 | ê°•í•¨(>6%) | ê¹ŠìŒ(>2.5%) | ê¹€(>4) | 3ê±´ | -1.50% |
| 10 | ë³´í†µ(4-6%) | ë³´í†µ(1.5-2.5%) | ê¹€(>4) | 3ê±´ | -1.50% |
| 11 | ì•½í•¨(<4%) | ê¹ŠìŒ(>2.5%) | ì§§ìŒ(â‰¤2) | 12ê±´ | -0.00% |

## ì˜ˆìƒ íš¨ê³¼

ë°±í…ŒìŠ¤íŠ¸ ë¶„ì„ ê²°ê³¼ ([analyze_negative_profit_combinations.py](analyze_negative_profit_combinations.py)):

- **ì´ ìˆ˜ìµ**: +31.3% ì¦ê°€ (156.35% â†’ 205.33%)
- **ìŠ¹ë¥ **: +4.0%p ì¦ê°€ (49.1% â†’ 53.1%)
- **í‰ê·  ìˆ˜ìµë¥ **: +68.3% ì¦ê°€ (0.286% â†’ 0.482%)
- **í•„í„°ë§ ë¹„ìœ¨**: ì•½ 20%ì˜ íŒ¨í„´ ì°¨ë‹¨

## ë¡œê·¸ì—ì„œ í•„í„° ë©”ì‹œì§€ê°€ ì•ˆ ë‚˜ì˜¤ëŠ” ì´ìœ 

### ì •ìƒì ì¸ ê²½ìš°:

1. **í•´ë‹¹ ë‚ ì§œì— 11ê°œ ì¡°í•©ì´ ë°œìƒí•˜ì§€ ì•ŠìŒ**
   - í•„í„°ëŠ” ì •ìƒ ì‘ë™ ì¤‘
   - ë§ˆì´ë„ˆìŠ¤ ì¡°í•©ì´ ì—†ìœ¼ë©´ ë¡œê·¸ì— í‘œì‹œ ì•ˆ ë¨

2. **ê³¼ê±° ë¡œê·¸ íŒŒì¼ í™•ì¸**
   - `signal_replay_log_prev/` ë””ë ‰í† ë¦¬ì˜ ë¡œê·¸ëŠ” í•„í„° ì ìš© ì „ì— ìƒì„±ë¨
   - ìƒˆë¡œ ìƒì„±ëœ ë¡œê·¸ë§Œ í•„í„° ë©”ì‹œì§€ í¬í•¨

### í•„í„°ê°€ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸í•˜ëŠ” ë°©ë²•:

```bash
# ìƒˆë¡œ signal replay ì‹¤í–‰
python -m utils.signal_replay --date 20251106

# ë¡œê·¸ì—ì„œ í•„í„° ë©”ì‹œì§€ ê²€ìƒ‰
grep "ë§ˆì´ë„ˆìŠ¤ ìˆ˜ìµ ì¡°í•©" signal_replay_log/signal_new2_replay_20251106_9_00_0.txt
```

**ì¤‘ìš”**: ë§ˆì´ë„ˆìŠ¤ ì¡°í•©ì´ ë°œìƒí•˜ì§€ ì•Šìœ¼ë©´ ë©”ì‹œì§€ê°€ ì—†ëŠ” ê²ƒì´ ì •ìƒì…ë‹ˆë‹¤.

## ê²°ë¡ 

âœ… **í•„í„°ê°€ ì •ìƒì ìœ¼ë¡œ ì‘ë™í•˜ê³  ìˆìŠµë‹ˆë‹¤.**

- í•„í„° ë¡œì§: ì •í™•í•˜ê²Œ ì‘ë™ (3/3 í…ŒìŠ¤íŠ¸ í†µê³¼)
- ì½”ë“œ í†µí•©: ì˜¬ë°”ë¥¸ ìœ„ì¹˜ì— í†µí•©ë¨
- ê³¼ê±° ë°ì´í„° ê²€ì¦: 19.7% í•„í„°ë§ í™•ì¸
- ì˜ˆìƒ íš¨ê³¼: +31.3% ìˆ˜ìµ ì¦ê°€

í•„í„°ëŠ” 11ê°œ ë§ˆì´ë„ˆìŠ¤ ìˆ˜ìµ ì¡°í•©ì„ ë§Œë‚˜ë©´ ìë™ìœ¼ë¡œ ì°¨ë‹¨í•˜ë©°, í•´ë‹¹ ì¡°í•©ì´ ë°œìƒí•˜ì§€ ì•Šìœ¼ë©´ ë¡œê·¸ì— ë©”ì‹œì§€ê°€ ë‚˜íƒ€ë‚˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì´ëŠ” ì •ìƒì ì¸ ë™ì‘ì…ë‹ˆë‹¤.

---

**ìƒì„±ì¼**: 2025-11-06
**ê²€ì¦ì**: Claude Code
**ê´€ë ¨ íŒŒì¼**:
- [pattern_combination_filter.py](core/indicators/pattern_combination_filter.py)
- [pullback_candle_pattern.py](core/indicators/pullback_candle_pattern.py)
- [test_filter_live.py](test_filter_live.py)
- [FILTER_STATUS.md](FILTER_STATUS.md)
